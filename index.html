<script>
  // Função para pegar parâmetros da URL
  function getParameterByName(name) {
    name = name.replace(/[\[\]]/g, '\\$&');
    const url = window.location.href;
    const regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)');
    const results = regex.exec(url);
    if (!results) return null;
    if (!results[2]) return '';
    return decodeURIComponent(results[2].replace(/\+/g, ' '));
  }

  window.addEventListener('DOMContentLoaded', () => {
    ['nome', 'email', 'telefone', 'motivo'].forEach(field => {
      const value = localStorage.getItem(field);
      if (value) {
        document.getElementById(field).value = value;
      }
    });
  });

  document.getElementById('visitForm').addEventListener('submit', function(e) {
    e.preventDefault();

    const nome = document.getElementById('nome').value.trim();
    const email = document.getElementById('email').value.trim();
    const telefone = document.getElementById('telefone').value.trim();
    const motivo = document.getElementById('motivo').value.trim();

    if (!nome || !email || !telefone || !motivo) {
      alert('Por favor, preencha todos os campos antes de enviar.');
      return;
    }

    localStorage.setItem('nome', nome);
    localStorage.setItem('email', email);
    localStorage.setItem('telefone', telefone);
    localStorage.setItem('motivo', motivo);

    // Captura todos os parâmetros da URL atual (incluindo base_grant_url)
    const params = window.location.search;

    // Redireciona para aguarde.html com todos os parâmetros originais
    window.location.href = 'aguarde.html' + params;
  });
</script>
